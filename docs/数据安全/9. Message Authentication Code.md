### 概述

**目的**

确认是发送者发送的，并且确保消息完整性。阻止敌手进行不被检测到的对消息的修改。（在加密情况下，只有通信双方都掌握了敌手不可知的秘密时才能实现，否则敌手可以伪装某一方来发送消息）

**语法**

假设发送端和接收端共享一个密钥，用来身份认证。发送端直接发送m和标记t($Mac_k(m)$)，只有key是不被知道的，利用消息验证算法进行验证。

![image-20230601193750179](../img/5.25/image-20230601193750179.png)

**攻破**

![image-20230601194722820](../img/5.25/image-20230601194722820.png)![image-20230601194742239](../img/5.25/image-20230601194742239.png)

**安全性定义**

![image-20230601194757954](../img/5.25/image-20230601194757954.png)

**重放攻击**

发送之前发送过的消息，MAC并不能阻止重放攻击，为了应对，可以添加序列号或者时间戳。但是序列号的缺点是需要被记录，时间戳的缺点是不能防御足够快的重放攻击。

### 构造安全的MAC

![image-20230601195559308](../img/5.25/image-20230601195559308.png)

![image-20230601195624563](../img/5.25/image-20230601195624563.png)

从定长MAC到变长MAC

![image-20230601200014073](../img/5.25/image-20230601200014073.png)

![image-20230601200021682](../img/5.25/image-20230601200021682.png)

### CBC-MAC

![image-20230601201049686](../img/5.25/image-20230601201049686.png)![image-20230601201107216](../img/5.25/image-20230601201107216.png)

### 抗碰撞散列函数

**抗碰撞的定义**

![image-20230601201406341](../img/5.25/image-20230601201406341.png)

!!! note 

    lost~


